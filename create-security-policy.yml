---
- hosts: firewalls
  connection: local
  gather_facts: False

  roles:
    - role: PaloAltoNetworks.paloaltonetworks

  tasks:
    - name: Add test rule 1 to the firewall
      panos_security_rule:
          provider: 
           username : "{{admin_username}}"
           password : "{{admin_username}}"
           ip_address : "{{mgmt_ip}}"
           api_key : "{{api_key}}"
          rule_name: 'Ansible test 1'
          description: 'An Ansible test rule'
          source_zone: ['internal']
          destination_zone: ['external']
          source_ip: ['1.2.3.4']
          source_user: ['any']
          destination_ip: ['any']
          category: ['any']
          application: ['any']
          service: ['service-http']
          hip_profiles: ['any']
          action: 'allow'
          commit: 'False'

    